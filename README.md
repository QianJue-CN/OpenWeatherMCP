# OpenWeatherMap MCP Server

ä¸€ä¸ªåŸºäº Model Context Protocol (MCP) çš„ OpenWeatherMap API é›†æˆæœåŠ¡å™¨ï¼Œä¸º AI åŠ©æ‰‹æä¾›å…¨é¢çš„å¤©æ°”æ•°æ®è®¿é—®èƒ½åŠ›ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒå¤©æ°”åŠŸèƒ½
- **ğŸŒ¡ï¸ å½“å‰å¤©æ°”æŸ¥è¯¢** - è·å–å®æ—¶å¤©æ°”æ•°æ®ï¼ŒåŒ…æ‹¬æ¸©åº¦ã€æ¹¿åº¦ã€é£é€Ÿã€æ°”å‹ç­‰
- **ğŸ“… å¤©æ°”é¢„æŠ¥** - 5å¤©/3å°æ—¶é—´éš”çš„è¯¦ç»†å¤©æ°”é¢„æŠ¥ï¼Œå«è¶‹åŠ¿åˆ†æ
- **ğŸ­ ç©ºæ°”è´¨é‡ç›‘æµ‹** - å®æ—¶ç©ºæ°”è´¨é‡æŒ‡æ•°å’Œæ±¡æŸ“ç‰©æµ“åº¦æ•°æ®
- **ğŸ—ºï¸ å¤©æ°”åœ°å›¾** - å¤šå›¾å±‚å¤©æ°”åœ°å›¾ç“¦ç‰‡ï¼ˆäº‘å±‚ã€é™æ°´ã€æ¸©åº¦ç­‰ï¼‰
- **âš ï¸ å¤©æ°”è­¦æŠ¥** - æ”¿åºœå‘å¸ƒçš„å¤©æ°”é¢„è­¦å’Œå®‰å…¨å»ºè®®
- **ğŸ“Š å†å²å¤©æ°”** - å†å²å¤©æ°”æ•°æ®æŸ¥è¯¢å’Œå¤šæ—¥å¯¹æ¯”åˆ†æ

### è¾…åŠ©åŠŸèƒ½
- **ğŸŒ åœ°ç†ç¼–ç ** - åœ°åè½¬åæ ‡ï¼Œæ”¯æŒæ¨¡ç³Šæœç´¢
- **ğŸ“ åå‘åœ°ç†ç¼–ç ** - åæ ‡è½¬åœ°åï¼Œè·å–ä½ç½®ä¿¡æ¯
- **ğŸ”„ å¤šå•ä½æ”¯æŒ** - å…¬åˆ¶ã€è‹±åˆ¶ã€æ ‡å‡†å•ä½ç³»ç»Ÿ
- **ğŸŒ å¤šè¯­è¨€æ”¯æŒ** - ä¸­æ–‡ã€è‹±æ–‡ç­‰å¤šç§è¯­è¨€

## ğŸ“¦ å®‰è£…

### å‰ç½®è¦æ±‚
- Node.js 18.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- OpenWeatherMap API å¯†é’¥

### è·å– API å¯†é’¥
1. è®¿é—® [OpenWeatherMap](https://openweathermap.org/api)
2. æ³¨å†Œè´¦æˆ·å¹¶è·å–å…è´¹ API å¯†é’¥
3. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
   ```bash
   export OPENWEATHER_API_KEY="your_api_key_here"
   ```

### å®‰è£…æ–¹å¼

#### æ–¹å¼ä¸€ï¼šNPM å…¨å±€å®‰è£…
```bash
npm install -g openweather-mcp
```

#### æ–¹å¼äºŒï¼šä»æºç æ„å»º
```bash
git clone https://github.com/your-org/openweather-mcp.git
cd openweather-mcp
npm install
npm run build
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ä½œä¸º MCP æœåŠ¡å™¨è¿è¡Œ
```bash
# è®¾ç½® API å¯†é’¥
export OPENWEATHER_API_KEY="your_api_key_here"

# å¯åŠ¨æœåŠ¡å™¨
npx openweather-mcp
```

### åœ¨ Claude Desktop ä¸­é…ç½®
åœ¨ Claude Desktop çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "openweather": {
      "command": "npx",
      "args": ["openweather-mcp"],
      "env": {
        "OPENWEATHER_API_KEY": "your_api_key_here"
      }
    }
  }
}
```

### åœ¨å…¶ä»– MCP å®¢æˆ·ç«¯ä¸­ä½¿ç”¨
ä»»ä½•æ”¯æŒ MCP åè®®çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥è¿æ¥åˆ°æ­¤æœåŠ¡å™¨ã€‚

## ğŸ› ï¸ å¯ç”¨å·¥å…·

### 1. å½“å‰å¤©æ°”æŸ¥è¯¢ (`get_current_weather`)
è·å–æŒ‡å®šä½ç½®çš„å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚

**å‚æ•°ï¼š**
- `city` (å¯é€‰): åŸå¸‚åç§°ï¼Œå¦‚ "åŒ—äº¬" æˆ– "Beijing,CN"
- `lat` (å¯é€‰): çº¬åº¦ (-90 åˆ° 90)
- `lon` (å¯é€‰): ç»åº¦ (-180 åˆ° 180)
- `zip` (å¯é€‰): é‚®æ”¿ç¼–ç ï¼Œå¦‚ "10001,US"
- `units` (å¯é€‰): å•ä½ç³»ç»Ÿ (metric/imperial/standard)
- `lang` (å¯é€‰): è¯­è¨€ä»£ç  (zh_cn/en/es/fr/de/ja/ko/ru)

**ç¤ºä¾‹ï¼š**
```json
{
  "city": "åŒ—äº¬",
  "units": "metric",
  "lang": "zh_cn"
}
```

### 2. å¤©æ°”é¢„æŠ¥ (`get_weather_forecast`)
è·å–5å¤©å¤©æ°”é¢„æŠ¥æ•°æ®ã€‚

**å‚æ•°ï¼š**
- ä½ç½®å‚æ•°åŒä¸Š
- `cnt` (å¯é€‰): é¢„æŠ¥æ—¶é—´ç‚¹æ•°é‡ (æœ€å¤š40ä¸ª)

**ç¤ºä¾‹ï¼š**
```json
{
  "lat": 39.9042,
  "lon": 116.4074,
  "cnt": 16,
  "units": "metric"
}
```

### 3. ç©ºæ°”è´¨é‡ (`get_air_quality`)
è·å–ç©ºæ°”è´¨é‡æ•°æ®ã€‚

**å‚æ•°ï¼š**
- `lat`: çº¬åº¦
- `lon`: ç»åº¦
- `start` (å¯é€‰): å¼€å§‹æ—¶é—´æˆ³ (å†å²æ•°æ®)
- `end` (å¯é€‰): ç»“æŸæ—¶é—´æˆ³ (å†å²æ•°æ®)

### 4. å¤©æ°”åœ°å›¾ (`get_weather_map`)
è·å–å¤©æ°”åœ°å›¾ç“¦ç‰‡ã€‚

**å‚æ•°ï¼š**
- `layer`: å›¾å±‚ç±»å‹ (clouds_new/precipitation_new/pressure_new/wind_new/temp_new)
- `z`: ç¼©æ”¾çº§åˆ« (0-10)
- `x`: ç“¦ç‰‡ X åæ ‡
- `y`: ç“¦ç‰‡ Y åæ ‡

### 5. å¤©æ°”è­¦æŠ¥ (`get_weather_alerts`)
è·å–å¤©æ°”é¢„è­¦ä¿¡æ¯ã€‚

**å‚æ•°ï¼š**
- `lat`: çº¬åº¦
- `lon`: ç»åº¦

### 6. å†å²å¤©æ°” (`get_historical_weather`)
æŸ¥è¯¢å†å²å¤©æ°”æ•°æ®ã€‚

**å‚æ•°ï¼š**
- `lat`: çº¬åº¦
- `lon`: ç»åº¦
- `dt`: æŸ¥è¯¢æ—¥æœŸçš„ Unix æ—¶é—´æˆ³
- `units`: å•ä½ç³»ç»Ÿ
- `lang`: è¯­è¨€ä»£ç 

### 7. åœ°ç†ç¼–ç  (`geocoding`)
æ ¹æ®åœ°åè·å–åæ ‡ã€‚

**å‚æ•°ï¼š**
- `q`: ä½ç½®æŸ¥è¯¢å­—ç¬¦ä¸²
- `limit`: è¿”å›ç»“æœæ•°é‡ (1-5)

### 8. åå‘åœ°ç†ç¼–ç  (`reverse_geocoding`)
æ ¹æ®åæ ‡è·å–åœ°åã€‚

**å‚æ•°ï¼š**
- `lat`: çº¬åº¦
- `lon`: ç»åº¦
- `limit`: è¿”å›ç»“æœæ•°é‡ (1-5)

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### æŸ¥è¯¢åŒ—äº¬å½“å‰å¤©æ°”
```json
{
  "tool": "get_current_weather",
  "parameters": {
    "city": "åŒ—äº¬",
    "units": "metric",
    "lang": "zh_cn"
  }
}
```

### è·å–ä¸Šæµ·5å¤©å¤©æ°”é¢„æŠ¥
```json
{
  "tool": "get_weather_forecast",
  "parameters": {
    "city": "ä¸Šæµ·",
    "units": "metric",
    "lang": "zh_cn"
  }
}
```

### æŸ¥è¯¢ç©ºæ°”è´¨é‡
```json
{
  "tool": "get_air_quality",
  "parameters": {
    "lat": 39.9042,
    "lon": 116.4074
  }
}
```

## ğŸ”§ å¼€å‘

### é¡¹ç›®ç»“æ„
```
src/
â”œâ”€â”€ index.ts              # MCP æœåŠ¡å™¨å…¥å£
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ weather.ts        # å¤©æ°”æ•°æ®ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ mcp.ts           # MCP å·¥å…·ç±»å‹å®šä¹‰
â”œâ”€â”€ services/
â”‚   â””â”€â”€ openweather.ts   # OpenWeatherMap API æœåŠ¡
â””â”€â”€ tools/
    â”œâ”€â”€ current-weather.ts    # å½“å‰å¤©æ°”å·¥å…·
    â”œâ”€â”€ forecast.ts          # å¤©æ°”é¢„æŠ¥å·¥å…·
    â”œâ”€â”€ air-pollution.ts     # ç©ºæ°”è´¨é‡å·¥å…·
    â”œâ”€â”€ weather-maps.ts      # å¤©æ°”åœ°å›¾å·¥å…·
    â”œâ”€â”€ weather-alerts.ts    # å¤©æ°”è­¦æŠ¥å·¥å…·
    â””â”€â”€ historical-weather.ts # å†å²å¤©æ°”å·¥å…·
```

### æ„å»ºå’Œæµ‹è¯•
```bash
# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev

# è¿è¡Œæµ‹è¯•
npm test

# ä»£ç æ£€æŸ¥
npm run lint
```

## ğŸŒ æ”¯æŒçš„ä½ç½®æ ¼å¼

### åŸå¸‚åç§°
- `"åŒ—äº¬"` - ä¸­æ–‡åŸå¸‚å
- `"Beijing"` - è‹±æ–‡åŸå¸‚å
- `"Beijing,CN"` - åŸå¸‚å+å›½å®¶ä»£ç 
- `"New York,US"` - å®Œæ•´æ ¼å¼

### åæ ‡
- çº¬åº¦ï¼š-90 åˆ° 90
- ç»åº¦ï¼š-180 åˆ° 180
- ç¤ºä¾‹ï¼š`lat: 39.9042, lon: 116.4074`

### é‚®æ”¿ç¼–ç 
- `"10001,US"` - ç¾å›½é‚®ç¼–
- `"100000,CN"` - ä¸­å›½é‚®ç¼–

## ğŸ“Š æ•°æ®æ ¼å¼

### æ¸©åº¦å•ä½
- `metric`: æ‘„æ°åº¦ (Â°C)
- `imperial`: åæ°åº¦ (Â°F)  
- `standard`: å¼€å°”æ–‡ (K)

### é£é€Ÿå•ä½
- `metric`: ç±³/ç§’ (m/s)
- `imperial`: è‹±é‡Œ/å°æ—¶ (mph)

### è¯­è¨€æ”¯æŒ
- `zh_cn`: ç®€ä½“ä¸­æ–‡
- `en`: è‹±è¯­
- `es`: è¥¿ç­ç‰™è¯­
- `fr`: æ³•è¯­
- `de`: å¾·è¯­
- `ja`: æ—¥è¯­
- `ko`: éŸ©è¯­
- `ru`: ä¿„è¯­

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **API é™åˆ¶**: å…è´¹è´¦æˆ·æœ‰è°ƒç”¨æ¬¡æ•°é™åˆ¶ï¼Œè¯·åˆç†ä½¿ç”¨
2. **å†å²æ•°æ®**: å†å²å¤©æ°”æ•°æ®éœ€è¦ä»˜è´¹è®¢é˜…
3. **One Call API**: å¤©æ°”è­¦æŠ¥åŠŸèƒ½éœ€è¦ One Call API 3.0 è®¢é˜…
4. **ç½‘ç»œè¿æ¥**: ç¡®ä¿æœåŠ¡å™¨èƒ½å¤Ÿè®¿é—® OpenWeatherMap API

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ”— ç›¸å…³é“¾æ¥

- [OpenWeatherMap API æ–‡æ¡£](https://openweathermap.org/api)
- [Model Context Protocol](https://modelcontextprotocol.io/)
- [Claude Desktop](https://claude.ai/desktop)
